# Zookeeper简介

zookeeper存储类似于标准文件系统。命名空间包括：数据寄存器znodes，和文件、目录一样。

zookeeper优点：

- 高性能，zookeeper数据保存在内存中，可以实现高吞吐量和低延迟的数据。
- 高可用，zookeeper集群可以防止单点故障。
- 严格的访问顺序，可以在客户端实现复杂的同步原件。

zookeeper功能简介：

- 复制，zookeeper自己在处理协调的时候要复制多个主机。服务组成部分必须要彼此知道彼此，维持了一个内存状态影像，连同事务日志和快照在一个持久化的存储中，只要大多数服务器是可用，就是可用的。
- 客户端连接到一个单独的服务，客户端保持了一个TCP连接，通过这个TCP连接发送请求、获取响应、获取watch事件、发送心跳，如果连接断了，会自动连接到其他不同的服务器。
- 序列，zookeeper用数字标记每一个更新，可以用来反映出所有的事务顺序，后面的操作可以使用这个顺序去实现更高级的抽象，比如同步组件。
- 快速，在读多写少的情况下运行最好。

## 数据模型和分层命名空间

zookeeper的命名空间很像一个标准的文件系统，一个名字是以一系列的以`/`隔开的路径元素，命名空间中的所有节点都是通过路径识别。

## 节点和临时节点

zookeeper命名空间中的每个节点可以有数据也可以有子目录。

临时节点和session存活时间一样长，session结束时临时节点也会被删除。

## 条件的更新和watches

客户端可以在znode上设置一个watch，当znode发生变化时触发并移除watch，当watch被触发时，客户端会接收到一个包说明znode有变化了。

## 保证

zookeeper提供了一套保证：

- 顺序一致性，来自客户端的更新会按顺序引用。
- 原子性，更新成功或失败，没有局部的结果产生。
- 唯一系统影像，一个客户端不管连接到哪个服务器端，都会看到同样的视图。
- 可靠性，一旦一个更新被应用，他将从更新的时间开始一直保持到一个客户端重写更新。
- 时效性，系统中的客户端视图在特定时间保证成为时最新的。

## 简单API

支持的操作：

- create，在树形结构的位置中创建节点。
- delete，删除一个节点。
- exists，测试节点在指定位置上是否存在。
- get data，从节点上读取数据。
- set data，往节点上写入数据。
- get children，检索一个节点的子节点列表。
- sync，等待传输数据。

