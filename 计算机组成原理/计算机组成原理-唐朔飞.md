# 第一章 计算机系统概论

## 1.2 计算机的基本组成

### 1.2.1 冯诺依曼计算机的特点

冯诺依曼机的特点如下：

- 计算机由运算器、存储器、控制器、输入设备和输出设备五大部件组成。

- 指令和数据以同等地位存放于存储器内，并可按地址寻访。

- 指令和数据均用二进制数表示。

- 指令由操作码和地址码组成，操作码用来表示操作的性质，地址码用来表示操作数在存储器中的位置。

- 指令在存储器内按顺序存放。通常，指令是顺序执行的，在特定条件下，可根据运算结果或根据设定的条件改变执行顺序。

- 机器以运算器为中心，输入输出设备与存储器间的数据传送通过运算器完成。

### 1.2.2 计算机的硬件框图

典型的冯诺依曼计算机是以运算器为中心的。现代的计算机已转化为以存储器为中心。

各部件功能如下：

- 运算器：用来完成算术运算和逻辑运算，并将运算的中间结果暂存在运算器内。

- 存储器：用来存放数据和程序。

- 控制器：用来控制、指挥程序和数据的输入、运行以及处理运算结果。

- 输入设备：用来将人们熟悉的信息形式转换为机器能识别的信息形式，常见的有键盘、鼠标等。

- 输出设备：可将机器运算结果转换为人们熟悉的细细形式，如打印机输出、显示器输出等。

运算器和控制器通常将它们合起来统称为中央处理器（Central Processing Unit，CPU）。把输入设备与输出设备简称为I/O设备（Input/Output Equipment）。

现代计算机可认为由三大部分组成：CPU、I/O设备及主存储器（Main Memory，MM）。CPU与主存储器合起来又可成为主机，I/O设备又可成为外部设备。

主存储器是存储器子系统中的一类，用来存放程序和数据，可以直接与CPU交换信息。另一类称为辅助存储器，简称辅存，又称外存。

算术逻辑单元（Arithmetic Logic Unit，ALU）简称算逻部件，用来完成算术逻辑运算。控制单元（Control Unit，CU）用来解释存储器中的指令，并发出各种操作命令来执行指令。ALU和CU是CPU的核心部件。

I/O设备也受CU控制，用来完成相应的输入、输出操作。

### 1.2.3 计算机的工作步骤

#### 主存储器

主存储器（简称主存或内存），包括：存储体M、各种逻辑部件、控制电路等。

存储体由许多存储单元组成，每个存储单元又包含若干个存储元件（或称存储基元、存储元），每个存储元件能寄存一位二进制代码0或1。

一个存储单元可存储一串二进制代码，称这串二进制代码为一个存储字，这串二进制代码的位数称为存储字长。存储字长可以是8位、16位或32位等。

可以赋予每个存储单元一个编号，称为存储单元的地址号。

主存的工作方式就是按存储单元的地址号来实现对存储字各位的存（写入）、取（读出）。这种存取方式称为按地址存储方式，即按地址访问存储器（简称访存）。

为了能实现按地址访问的方式，主存中还必须配置两个寄存器MAR和MDR。MAR（Memory Address Register）是存储器地址寄存器，用来存放欲访问的存储单元的地址，其位数对应存储单元的个数（如MAR为10位，则有2^10=1024个存储单元，记为1K）。MDR（Memory Data Register）是存储器数据寄存器，用来存放从存储体某单元取出的代码或准备往某存储单元存入的代码，其位数与存储字长相等。

#### 运算器

运算器最少包括3个寄存器（现代计算机内部往往设有通用寄存器组）和一个算术逻辑单元（ALU）。其中ACC（Accumulator）为累加器，MQ（Multiplier-Quotient Register）为乘商寄存器，X为操作数寄存器。

运算器加、减、乘、除四则运算的操作过程，假设：

- M表示存储器的任一地址号

- [M]表示对应M地址号单元中的内容

- X表示X寄存器

- [X]表示X寄存器中的内容

- ACC表示累加器

- [ACC]表示累加器中的内容

- MQ表示乘商寄存器

- [MQ]表示乘商寄存器中的内容

假设ACC中已存有前一时刻的运算结果，并作为下述运算中的一个操作数。

加法操作过程为：

```
[M] -> X
[ACC] + [X] -> ACC
```

即将[ACC]看作被加数，先从主存中取一个存放在M地址号单元内的加数[M]，送至运算器的X寄存器中，然后将被加数[ACC]与加数[X]相加，结果（和）保留在ACC寄存器中。

减法操作过程为：

```
[M] -> X
[ACC] - [X] -> ACC
```

即将[ACC]看作被减数，先取出存放在主存M地址号单元中的减数[M]并送入X，然后[ACC]-[X]，结果（差）保留在ACC寄存器中。

乘法操作过程为：

```
[M] -> MQ
[ACC] -> X
0 -> ACC
[X] x [MQ] -> ACC//MQ（//表示两个寄存器串接）
```

即将[ACC]看作被乘数，先取出存放在主存M号地址单元中的乘数[M]并送入乘商寄存器MQ，再把被乘数送入X寄存器，并将ACC清0，然后[X]和[MQ]相乘，结果（积）的高位保留在ACC中，低位保留在MQ中。

除法操作过程为：

```
[M] -> X
[ACC] / [X] -> M
余数R在ACC中
```

即将[ACC]看作被除数，先取出存放在主存M号地址单元内的除数[M]并送至X寄存器，然后[ACC]除以[X]，结果（商）暂留于MQ，[ACC]为余数R。

#### 控制器

控制器首先要命令存储器读出一条指令，称为取指过程（也称取指阶段）。

接着，它要对这条指令进行分析，指出该指令要完成什么样的操作，并按寻址特征指明操作数的地址，称为分析过程（也称分析阶段）。

最后根据操作数所在的地址以及指令的操作码完成某种操作，称为执行过程（也称执行阶段）

控制器由程序计数器（Program Counter，PC）、指令寄存器（Instruction Register，IR）以及控制单元（CU）组成。

PC用来存放当前欲执行指令的地址，它与主存的MAR之间有一条直接通路，具有自动加1的功能，即可自动形成下一条指令的地址。

IR用来存放当前的指令，IR的内容来自主存的MDR。IR中的操作码OP送至CU，用来分析指令；地址码Ad作为操作数的地址送至存储器的MAR。

CU用来分析当前指令所需完成的操作，并发出各种微操作命令序列，用以控制所有被控对象。

#### I/O

I/O子系统包括各种I/O设备及其相应的接口。每一种I/O设备都由I/O接口与主机联系，它接收CU发出的各种控制命令，并完成相应的操作。

## 1.3 计算机硬件的主要技术指标

### 1.3.1 机器字长

机器字长是指CPU一次能处理数据的位数，通常与CPU的寄存器位数有关。字长越长，数的表示范围越大，精度也越高。

### 1.3.2 存储容量

存储容量包括：主存容量、辅存容量。

主存容量是指主存中存放二进制代码的总位数，即：存储容量 = 存储单元个数 x 存储字长。

MAR的位数反映了存储单元的个数，MDR的位数反应了存储字长。例如，MAR为16位，即存储体内的存储单元个数为2^16=65535个（即64K个存储字，1K=1024=2^10）；MDR为32位，表示存储容量为2^16 x 32=2^21 = 2M位（1M=2^20）。

现代计算机中常以字节数来描述容量的大小，一个字节被定义为8位二进制代码。例如，上述存储容量为2M位，也可以用2^18字节表示，记作2^18B或256KB（B用来表示一个字节）。

辅存容量通常用字节数来表示。

### 1.3.3 运算速度

计算机的运算速度与许多因素有关，如机器的主频、执行什么样的操作、主存本身的速度等都有关。

衡量运算速度的方法：

- 完成一次加法或乘法所需的时间，即普通法

- 吉普森法，综合考虑每条指令执行时间以及它们在全部操作中所占的百分比

- 时间单位内执行指令的平均条数，并用MIPS（Million Instruction Per Second，百万条指令每秒）作为计量单位

- CPI（Cycle Per Instruction）即执行一条指令所需的时钟周期数

- FLOPS（Floating Point Operation Per Second）浮点运算次数每秒

# 第3章 系统总线

## 3.1 总线的基本概念

计算机五大部件之间的互连方式有两种：

- 各部件之间使用单独的连线，称为分散连接

- 各部件连接到一组公共信息传输线上，称为总线连接

总线实际上是由许多传输线或通路组成，每条线可一位一位的传输二进制代码，若干条传输线可以同时传输若干位二进制代码。例如，16条传输线组成的总线可同时传输16位二进制代码。

连接CPU和主存的总线，称为存储总线（M总线）；建立CPU和各I/O设备之间交换信息的通道，称为输入输出总线（I/O总线）。

## 3.2 总线的分类

### 3.2.1 片内总线

片内总线是指芯片内部的总线，如在CPU芯片内部，寄存器与寄存器之间、寄存器与算术逻辑单元ALU之间都由片内总线连接。

### 3.2.2 系统总线

系统总线是指CPU、主存、I/O设备（通过I/O接口）各大部件之间的信息传输线。由于这些部件通常安放在主办或各个插件板（插卡）上，故又称板级总线或板间总线。

系统总线分三类：

- 数据总线：用来传输各功能部件之间的数据信息，是双向传输总线，其位数与机器字长、存储字长有关，一般为8位、16位或32位。数据总线的位数称为数据总线宽度。

- 地址总线：用来指出数据总线上的源数据或目的数据在主存单元的地址或I/O设备的地址。地址总线上的代码是用来指明CPU欲访问的存储单元或I/O端口的地址，由CPU输出，单向传输。地址线的位数与存储单元的个数有关，如地址线为20根，则对应存储单元的个数为2^20。

- 控制总线：用来发出各种控制信号的传输线。通常对任一控制线而言，它的传输是单向的。但对于控制总线总体来说，又可认为是双向的。控制总线还起到监视各部件状态的作用。对CPU而言，控制信号既有输出，又有输入。

常见的控制信号如下：

- 时钟：用来同步各种操作

- 复位：初始化所有部件

- 总线请求：表示某部件需获得总线使用权

- 总线允许：表示需要获得总线使用权的部件已获得了控制权

- 中断请求：表示某部件提出中断请求

- 中断响应：表示中断请求已被接收

- 存储器写：将数据总线上的数据写至存储器的指定地址单元内

- 存储器读：将指定存储器单元中的数据读到数据总线上

- I/O读：从指定的I/O端口将数据读到数据总线上

- I/O写：将数据总线上的数据输出到指定的I/O端口内

- 传输响应：表示数据已被接收，或已将数据送至数据总线上

### 3.2.3 通信总线

通信总线用于计算机系统之间或计算机系统与其他系统之间的通信。按照传输方式可分为两种：

- 串行通信

- 并行通信

## 3.3 总线特性及性能指标

### 3.3.1 总线特性

总线特性包括以下几项：

- 机械特性：指总线在机械连接方式上的一些性能，如插头与插座使用的标准，它们的几何尺寸、形状、引脚的个数以及排列的顺序，接头处的可靠接触等。

- 电气特性：指总线的每一根传输线上信号的传递方向和有效电平范围。通常规定由CPU发出的信号为输出信号，送入CPU的信号为输入信号。

- 功能特性：指总线中每根传输线的功能。例如：地址总线用来指出地址码；数据总线用来传递数据；控制总线发出控制信号等。

- 时间特性：指总线中的任一根线在什么时间内有效。每条总线上的各种信号互相存在一种有效时序的关系，因此时间特性一般可用信号时序图来描述。

### 3.3.2 总线性能指标

总线性能指标如下：

- 总线宽度：指数据总线的根数，用bit（位）来表示，如8位、16位、32位、64位（即8根、16根、32根、64根）。

- 总线带宽：指总线的传输速率，即单位时间内总线上传输数据的位数，通常用每秒传输信息的字节数来衡量，单位可用MBps（兆字节每秒）表示。例如，总线工作频率为33MHz，总线宽度位32位（4B），则总线带宽位33x(32/8)=132MBps。

- 时钟同步/异步：总线上的数据与时钟同步工作的总线称为同步总线；与时钟不同步工作的总线称为异步总线。

- 总线复用：一条信号线上分时传送两种信号。为了提高总线利用率，优化设计，将地址总线和数据总线共用一组物理线路，在这组物理线路上分时传输地址信号和数据信号，即为总线的多路复用。

- 信号线数：地址总线、数据总线和控制总线三种总线数的总和。

- 总线控制方式：包括突发工作、自动配置、仲裁方式、逻辑方式、计数方式等。

- 其他指标：负载能力、电源电压、总线宽度能否扩展等。

### 3.3.3 总线标准

流行的总线标准有以下几种：

- ISA总线

- EISA总线

- VESA（VL-BUS）总线

- PCI总线

- AGP总线

- RS-232C总线

- USB总线